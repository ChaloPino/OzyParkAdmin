@page "/escenario-cupo-editor-dialog"
@using OzyParkAdmin.Components.Admin.Mantenedores.EscenariosCupo.Models
@using OzyParkAdmin.Components.Admin.Mantenedores.EscenariosCupo.Controls
@using OzyParkAdmin.Components.Admin.Mantenedores.EscenariosCupo.Validators
@inject EscenarioCupoValidator Validator;

<MudDialog Options="DialogOptions" Visible="IsOpen" VisibleChanged="ChangeIsOpen">
    <DialogContent>
        <IfThen Condition="ViewModel.Loading">
            <Then>
                <MudProgressLinear Color="@Color.Primary" Class="mud-table-loading-progress" Indeterminate="true" />
            </Then>
        </IfThen>

        <MudTabs>
            <!-- Tab Escenario Cupo -->
            <MudTabPanel Text="Escenario Cupo">
                <CreateEscenarioCupoLayout @ref="editEscenarioCupoForm"
                                           Validator="Validator"
                                           escenarioCupo="SelectedEscenarioCupo"
                                           CentrosCostos="CentrosCostos"
                                           Zonas="Zonas" />
            </MudTabPanel>

            <!-- Tab Detalles -->
            <MudTabPanel Text="Detalles">
                <!-- Componente de detalles, notificará al agregar uno -->
                <CreateDetalleEscenarioCupoLayout Detalles="SelectedEscenarioCupo.Detalles"
                                                  Servicios="Servicios"
                                                  EscenarioSeleccionado="SelectedEscenarioCupo"
                                                  OnDetalleAgregado="OnDetalleAgregado" />
            </MudTabPanel>
        </MudTabs>
    </DialogContent>

    <DialogActions>
        <MudButton Variant="Variant.Filled" Color="Color.Default" OnClick="CancelEditingItemAsync" Disabled="ViewModel.Loading" Class="px-10">Cancelar</MudButton>
        <MudButton Variant="Variant.Filled" Color="Color.Primary" OnClick="CommitItemChangesAsync" Disabled="ViewModel.Loading || !EsValidoParaGuardar" Class="px-10">Guardar</MudButton>
    </DialogActions>
</MudDialog>
